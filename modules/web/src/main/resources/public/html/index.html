<!DOCTYPE HTML>
<html>
    <head>

        <script type="text/javascript">
            function WebSocketTest()
            {
                if ("WebSocket" in window)
                {
                    console.log("WebSocket is supported by your Browser!");

                    var clientId = Math.floor(Math.random() * (10 - 1) + 1)
                        console.log("WebSocket clientId: " + clientId);

                    var self = this;

                    var open = function() {
                        console.log("Connection is opened...");
                        self.ws = new WebSocket("ws://localhost:8080/updates/" + clientId);

                        self.ws.onopen = function()
                        {
                            // Web Socket is connected, send data using send()
                            ws.send("Message to send");
                            console.log("Message is sent...");
                        };

                        self.ws.onmessage = function (evt)
                        {
                            var received_msg = evt.data;
                            console.log("Message is received:\n" + received_msg);
                        };

                        self.ws.onclose = function()
                        {
                            // websocket is closed.
                            console.log("Connection is closed...");
                            open();
                        };
                    }

                    open();
                }

                else
                {
                    // The browser doesn't support WebSocket
                    console.log("WebSocket NOT supported by your Browser!");
                }
            }
        </script>

    </head>
    <body>

        <div id="sse">
            <a href="javascript:WebSocketTest()">Run WebSocket</a>
        </div>

    </body>
</html>
